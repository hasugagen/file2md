# **ファイルMarkdown変換ツール仕様書**

## **1\. 概要**

本ドキュメントは、指定されたフォルダ内に存在する各種ドキュメントファイルを一括でMarkdown形式に変換するコマンドラインツールの開発仕様を定義するものである。

Microsoftが提供するmarkitdownライブラリを全面的に活用し、Windows環境で動作する単一の実行ファイル（.exe）として提供することを目指す。

## **2\. 機能要件**

### **2.1. 基本機能**

* 指定されたファイルまたはフォルダを対象に、Markdownへの変換処理を行う。  
* **処理対象のファイル形式:** markitdownがサポートする全ての形式を対象とする。  
  * 主な対象: PDF (.pdf), Word (.docx), Excel (.xlsx), PowerPoint (.pptx) など。  
* 変換後のMarkdownファイルは、指定された出力先フォルダに保存する。

### **2.2. 入力仕様**

* **対象パスの指定:**  
  * 変換対象となるファイルやフォルダのパスをコマンドライン引数で指定できる。  
  * ワイルドカード（例: C:\\data\\report\_\*.xlsx）を利用した複数ファイルの指定に対応する。  
* **サブフォルダの再帰的検索:**  
  * 指定されたフォルダ配下にあるサブフォルダも全て検索対象とするオプション機能を持つ。

### **2.3. 変換ロジック**

* **全ファイル共通:**  
  * Microsoftのmarkitdownライブラリを利用してMarkdownへの変換を行う。  
* **Excel (.xlsx) ファイルの特殊処理:**  
  * markitdownでExcelファイルを変換する際、ファイル内に複数のシートが存在する場合は、**各シートを個別のMarkdownファイルとして出力する。**  
  * 出力ファイル名は {元のファイル名}\_{シート名}.md の形式とする。  
  * 例: data.xlsx（シート名: "売上", "費用"） → data\_売上.md, data\_費用.md

### **2.4. 出力仕様**

* **出力先:**  
  * 変換後のファイルの出力先フォルダをコマンドライン引数で指定できる。  
  * 出力先が指定されなかった場合、**入力ファイルと同一のフォルダ**をデフォルトの出力先とする。  
* **フォルダ構造の維持:**  
  * \--outputオプションで出力先フォルダを指定した場合、入力元のフォルダ階層を維持して保存する。  
  * 例: C:\\input\\dir1\\sample.xlsx を D:\\output に出力する場合、D:\\output\\dir1\\sample.md として保存される。  
* **ファイル名:**  
  * 出力ファイル名は、元のファイル名の拡張子を.mdに変更したものを基本とする。（Excelの複数シートの場合は2.3の仕様に従う）  
* **既存ファイルの扱い:**  
  * 出力先に同名のファイルが既に存在する場合、**警告なしに上書きする。**

## **3\. 実行環境**

* **プラットフォーム:** Windows 10 / 11  
* **実行形式:** コマンドプロンプトから実行可能な、単一のスタンドアロン実行ファイル (.exe)。  
* **開発言語:** Python 3.x  
* **Exe化:** PyInstallerなどのツールを利用して、依存ライブラリを含んだ単一ファイル形式にパッケージングする。

## **4\. コマンドラインインターフェース (CLI) 仕様**

**実行ファイル名:** file2md.exe (仮)

| 引数 | 短縮形 | 必須 | 説明 |
| :---- | :---- | :---- | :---- |
| \--input \<path\> | \-i \<path\> | **はい** | 変換対象のファイルまたはフォルダのパス。ワイルドカード使用可。 |
| \--output \<path\> | \-o \<path\> | いいえ | 変換後のファイルの出力先フォルダ。省略時は入力元と同じ場所に出力。 |
| \--recursive | \-r | いいえ | このフラグを指定すると、入力フォルダのサブフォルダも再帰的に検索する。 |

### **実行例**

**例1: 単一フォルダ内のファイルを変換し、別のフォルダに出力**

file2md.exe \--input "C:\\Users\\user\\Documents\\Reports" \--output "D:\\Markdown\_Files"

C:\\Users\\user\\Documents\\Reports 内の全サポート対象ファイルを D:\\Markdown\_Files に変換・保存する。サブフォルダは対象外。

**例2: サブフォルダを含めて再帰的に変換（ご希望のイメージ）**

file2md.exe \-i "C:\\Users\\user\\Documents\\Reports" \-o "D:\\Markdown\_Files" \-r

C:\\Users\\user\\Documents\\Reports とその全てのサブフォルダ内のファイルを対象とし、D:\\Markdown\_Files に元のフォルダ構造を維持して保存する。

**例3: ワイルドカードを使い、同じ場所に出力**

file2md.exe \--input "C:\\Project\\data\\2024\_\*.pdf"

C:\\Project\\data\\ フォルダにある、2024\_で始まる全てのPDFファイルをMarkdownに変換し、同フォルダ内に.mdファイルとして保存する。

## **5\. 依存ライブラリ（想定）**

* microsoft-markitdown: ファイル変換のコアライブラリ  
* PyInstaller: Pythonスクリプトをexe化するために利用